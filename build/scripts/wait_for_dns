#!/bin/sh

hostname="$1"
timeout="${2:-60}"
interval="${3:-3}"
start_time=$(date +%s)
echo "Waiting for DNS ..."
while true; do
    if getent hosts "$hostname" >/dev/null 2>&1; then
        exit 0
    fi
    now=$(date +%s)
    elapsed=$((now - start_time))
    if [ "$elapsed" -gt "$timeout" ]; then
        echo "Timeout waiting to resolve $hostname"
        exit 1
    fi
    echo "    retrying in ${interval}s..."
    sleep "$interval"
done

